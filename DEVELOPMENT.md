# SlimeGobble - 开发文档

## 第一阶段实现总结

### ✅ 已完成功能

1. **游戏框架** ✓
   - 完整的Pygame主循环
   - 事件处理系统
   - 60 FPS帧率控制

2. **游戏状态管理** ✓
   - `MAIN_MENU` - 主菜单（带开始按钮）
   - `PLAYING` - 游戏进行中
   - `PAUSED` - 暂停功能（按P键）
   - `LEVEL_COMPLETE` - 关卡完成提示
   - 其他状态（GAME_OVER, VICTORY）已预留

3. **关卡设计** ✓
   - 3个关卡完整地图定义（15x18网格）
   - 使用2D列表存储地图数据
   - 地图元素：墙壁(W)、玩家出生点(P)、敌人出生点(E)、金币(.)、大金币(O)
   - 关卡难度递增设计

4. **Player类** ✓
   - 完整的玩家角色实现
   - WASD键盘控制（上下左右）
   - 四方向动画系统（支持JSON雪碧图数据）
   - 墙壁碰撞检测
   - 平滑移动和方向切换

5. **游戏逻辑** ✓
   - 金币收集系统（小金币10分，大金币50分）
   - 分数统计和显示
   - 关卡推进判定（500分升级）
   - HUD显示（分数/500、关卡、生命值）

6. **UI系统** ✓
   - 主菜单界面
   - 游戏内HUD
   - 关卡完成提示
   - 鼠标悬停按钮高亮效果

### 📁 项目结构

```
SlimeGobble/
├── main.py          # 游戏入口文件
├── game.py          # Game类 - 游戏主逻辑
├── player.py        # Player类 - 玩家控制
├── config.py        # 配置文件 - 常量和地图数据
├── venv/            # Python虚拟环境
└── README.md        # 项目说明
```

### 🎮 如何运行

#### 1. 激活虚拟环境
```bash
source venv/bin/activate
```

#### 2. 确保已安装依赖
```bash
pip install pygame numpy
```

#### 3. 运行游戏
```bash
python main.py
```

### 🎯 控制说明

- **W** - 向上移动
- **A** - 向左移动  
- **S** - 向下移动
- **D** - 向右移动
- **P** - 暂停/继续
- **ESC** - 返回主菜单
- **鼠标点击** - 主菜单中点击"Start Game"按钮

### 🎨 美术资产说明

**当前状态**：由于美术资产位于本地路径 `/Users/liyutong/Desktop/assets`，在dev container中无法访问，游戏使用占位符颜色块：
- **玩家** - 绿色方块（未来将使用slime动画）
- **墙壁** - 蓝色方块
- **金币** - 黄色方块（未来使用coin.png）
- **大金币** - 红色方块（未来使用big coin.png）

**所需资产列表**：
```
/Users/liyutong/Desktop/assets/
├── slime front.png + json
├── slime back.png + json
├── slime left.png + json
├── slime right.png + json
├── coin.png
├── big coin.png
├── big coin.wav
├── bgm.wav
├── win.wav
├── tap.wav
└── lose.wav
```

**如何添加资产**：
1. 将 `assets` 文件夹复制到项目根目录
2. 修改 `config.py` 中的 `ASSETS_PATH`：
   ```python
   ASSETS_PATH = './assets'  # 或使用绝对路径
   ```

### ✨ 游戏特性

1. **流畅的动画系统**
   - 玩家移动时播放行走动画
   - 静止时显示第一帧
   - 支持JSON格式的雪碧图数据

2. **精确的碰撞检测**
   - 基于像素级的墙壁碰撞
   - 检测玩家矩形的四个角
   - 防止穿墙和越界

3. **实时得分系统**
   - 收集金币即时加分
   - HUD实时显示进度（当前分数/500）
   - 达到500分自动进入下一关

### 🔧 技术细节

#### 坐标系统
- **网格坐标**：地图数组的行列索引
- **像素坐标**：屏幕上的实际位置（网格坐标 × TILE_SIZE）
- **TILE_SIZE**: 32×32像素

#### 动画系统
- 支持JSON格式的帧数据（Aseprite导出）
- 帧索引循环管理
- 可配置的动画速度（默认0.15）

#### 地图解析
- 自动识别玩家出生点(P)
- 自动识别敌人出生点(E)
- 自动收集金币位置
- 出生点解析后替换为空地

### 📋 下一阶段开发计划

第二阶段将实现：
1. **Enemy类** - 敌人AI和移动逻辑
2. **碰撞系统** - 玩家与敌人的碰撞检测
3. **生命系统** - 生命值管理和重生机制
4. **关卡推进** - 完整的3关流程
5. **音效系统** - BGM和音效播放
6. **游戏结束** - GAME_OVER和VICTORY状态

### 🐛 已知问题

1. ✅ 美术资产路径需要根据实际环境调整
2. ✅ 暂无音效播放（下一阶段实现）
3. ✅ 敌人系统未实现（下一阶段实现）
4. ✅ 生命损失机制未实现（下一阶段实现）

### 💡 验证清单

- [x] 游戏窗口正常打开
- [x] 主菜单显示并可点击
- [x] 玩家可使用WASD移动
- [x] 玩家不能穿墙
- [x] 收集金币会加分
- [x] 收集大金币会加更多分
- [x] HUD显示分数、关卡、生命
- [x] 达到500分显示"关卡完成"
- [x] 按P键可暂停/继续
- [x] 按ESC可返回主菜单

---

## 开发者备注

这是SlimeGobble项目的第一阶段实现。核心框架已经完成，包括：
- ✅ 完整的游戏循环
- ✅ 状态管理系统
- ✅ 玩家控制和动画
- ✅ 关卡地图加载
- ✅ 碰撞检测
- ✅ 得分系统

游戏已经可以正常运行和游玩，验证了基础架构的正确性。下一阶段将添加敌人AI、生命系统和音效，完成完整的游戏体验。
